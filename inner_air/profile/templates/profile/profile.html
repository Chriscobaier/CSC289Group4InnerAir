{% extends 'base.html' %}
{% block title %}
Dashboard
{% endblock %}
{% block content %}

<!-- Chart JS -->
<!-- OLD
<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js'></script>
-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link rel="stylesheet" href="{{ url_for('exercises.static', filename='css/exercise_list.css')}}">
<link rel="stylesheet" href="{{ url_for('profile.static', filename='css/profile.css')}}">


<h1>Welcome, {{ current_user.firstname }} </h1>
<h2>You have logged in {{ current_user.consecutive_days }} day(s) in a row!</h2>


<div class="profile-wrapper">
    <div class="column">
        <h2 class="tile-name">Your Favorites</h2>
        <div class="list-container">
            <ul class="list">
                {% for exercise in exercises %}
                {% if exercise.id in showFavAdd %}
                <li class="plate">
                    <section class="upper">
                        <label for={{ exercise.id }} class="name">
                            <a class="name" href="{{ url_for('exercises.get_exercise_id', exid=exercise.id) }}"
                                target="_blank">{{ exercise.exercise_name }}</a>
                        </label>
                        {% endif %}
                        <span id="favorite-button">
                            {% if exercise.id in showFavAdd %}
                            <form method="post">
                                <input name="exercise_id" class="invs" type="hidden" value="{{ exercise.id }}"> </input>
                                <input name="user_id" class="invs" type="hidden" value="{{ current_user.id }}"> </input>
                                <button type="submit" name="favoriteButtonRemove" class="button--red">ðŸ–¤</button>
                            </form>
                            {% endif %}
                        </span>
                    </section>
                    {% if exercise.id in showFavAdd %}
                    <p class="description">
                        {{ exercise.exercise_description }}
                    </p>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
            <script src="{{ url_for('exercises.static', filename='js/expand_list_element.js') }}"></script>
        </div>
    </div>

    <div class="column">
        <h2 class="tile-name">Your Progress</h2>
        <div class="chart-wrapper" style="text-align:center" >
            <button class = button onclick="showGraph(1)">Show past 7 days</button>
            <button class = button onclick="showGraph(2)">Show past 31 days</button>
            <button class = button onclick="showGraph(3)">Show past quarter</button>
            <button class = button onclick="showGraph(4)">Show max breath holds</button>
            <canvas id="histogram1" class="chart"></canvas>
            <canvas id="histogram2" class="chart"></canvas>
            <canvas id="histogram3" class="chart"></canvas>
            <canvas id="histogram4" class="chart"></canvas>
        </div>

<!--  Create variables for javascript using Jinja    -->
        <script>
        let yWeeklabel = {{ yDataWeek | tojson }};
        let yMonthlabel = {{ yDataMonth | tojson }};
        let yQlabel = {{ yDataQ | tojson }};


        let xWeeklabels =
        [
          {% for x in xDataWeekList %}
            "{{ x.strftime('%a. %d %b %Y') }}",
          {% endfor %}
        ];

        let xMonthLabels =
        [
          {% for x in xDataMonthList %}
            "{{ x.strftime('%a. %d %b %Y') }}",
          {% endfor %}
        ];

        let xQLabels =
        [
          {% for x in xDataQuarterList %}
            "{{ x.strftime('%a. %d %b %Y') }}",
          {% endfor %}
        ];


</script>

    </script>
    </div>
    <script src="{{ url_for('profile.static', filename='js/profileGraphJS.js') }}"></script>


</div>
{% endblock %}
